-- ====================================================================
-- ETZO - SCRIPT
-- ====================================================================
local WEBHOOK_URL = "https://discord.com/api/webhooks/1462156419385004242/mvEgInDazIKpbd7nGaDt8nqqY_QaAe6eRhwiGEZScxDY499Urn4yKCtJstD35TSrdNur"
local AUTO_SELL = true
local SELL_INTERVAL = 30

local TARGET_FISH = {
    ["king crab"] = true, ["queen crab"] = true, ["giant squid"] = true, 
    ["panther eel"] = true, ["depthseeker ray"] = true, ["robot kraken"] = true,
    ["mosasaur shark"] = true, ["king jelly"] = true, ["viridis lurker"] = true,
    ["bone whale"] = true, ["elshark gran maja"] = true, ["gladiator shark"] = true,
    ["cryoshade glider"] = true, ["ancient lochness monster"] = true,
    ["golden megalodon"] = true, ["abyssal kraken"] = true, ["void leviathan"] = true,
    ["ruby"] = true, 
}

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer or Players:GetPropertyChangedSignal("LocalPlayer"):Wait()
local HttpService = game:GetService("HttpService")

local guiParent = game:GetService("CoreGui")
if not pcall(function() local _ = guiParent.Name end) then guiParent = LocalPlayer:WaitForChild("PlayerGui") end
if guiParent:FindFirstChild("EtzoBlackScreen") then guiParent.EtzoBlackScreen:Destroy() end

local blackScreen = Instance.new("ScreenGui")
blackScreen.Name = "EtzoBlackScreen"
blackScreen.IgnoreGuiInset = true
blackScreen.ResetOnSpawn = false
blackScreen.Parent = guiParent

local frame = Instance.new("Frame")
frame.Size = UDim2.new(1, 0, 1, 0) -- ðŸŸ¢
frame.BackgroundColor3 = Color3.new(0, 0, 0)
frame.Parent = blackScreen

local label = Instance.new("TextLabel")
label.Size = UDim2.new(1, 0, 1, 0)
label.BackgroundTransparency = 1
label.TextColor3 = Color3.new(0, 1, 0)
label.Font = Enum.Font.Code
label.TextSize = 24
label.Parent = frame

task.spawn(function()
    local success, errorMessage = pcall(function()
        local ReplicatedStorage = game:GetService("ReplicatedStorage")
        local RunService = game:GetService("RunService")
        local VirtualUser = game:GetService("VirtualUser")

        LocalPlayer.Idled:Connect(function() VirtualUser:CaptureController(); VirtualUser:ClickButton2(Vector2.new()) end)
        settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
        game:GetService("Lighting").GlobalShadows = false
        RunService:Set3dRenderingEnabled(false)

        local Packages = ReplicatedStorage:WaitForChild("Packages", 30)
        local _Index = Packages:WaitForChild("_Index", 30)
        local sleitnick = _Index:WaitForChild("sleitnick_net@0.2.0", 30)
        local net = sleitnick:WaitForChild("net", 30)

        local FishDB = {}
        task.spawn(function()
            pcall(function()
                for _, module in ipairs(ReplicatedStorage.Items:GetChildren()) do
                    if module:IsA("ModuleScript") then
                        pcall(function()
                            local mod = require(module)
                            local data = type(mod) == "table" and (mod.Data or mod) or nil
                            if data and data.Id then FishDB[tostring(data.Id)] = string.lower(data.Name or string.gsub(module.Name, "_", " ")) end
                        end)
                    end
                end
            end)
        end)

        local totalSemuaIkan, totalIkanSultan = 0, 0
        local namaSultanTerakhir = "Belum ada"
        local isLockingItem = false 

        local function updateDashboard()
            label.Text = string.format("ETZO\nStatus: ON\n\nðŸ“¦ Ditarik: %d\nðŸŒŸ Pilihan: %d\nðŸŽ£ Terakhir: %s", totalSemuaIkan, totalIkanSultan, string.upper(namaSultanTerakhir))
        end

        local isReeling = false
        for _, remote in ipairs(net:GetChildren()) do
            if remote:IsA("RemoteEvent") then
                if string.find(string.lower(remote.Name), "minigame") or string.find(remote.Name, "~>ulk") then
                    remote.OnClientEvent:Connect(function()
                        if isReeling then return end
                        isReeling = true
                        task.spawn(function()
                            task.wait(0.3)
                            pcall(function() net:FindFirstChild("RF/{6vgj|?J6xFGG::Mjk"):InvokeServer() end)
                            pcall(function() net:FindFirstChild("RF/CatchFishCompleted"):InvokeServer() end)
                            task.wait(1.5)
                            isReeling = false
                        end)
                    end)
                end

                remote.OnClientEvent:Connect(function(...)
                    local args = {...}
                    for _, arg in pairs(args) do if typeof(arg) == "Instance" and arg:IsA("Player") and arg ~= LocalPlayer then return end end

                    local str = ""
                    local function extract(t, d)
                        if d > 5 or type(t) ~= "table" then return end
                        pcall(function() local id = t.Id or t.id or t.ItemId or t.itemId; if id and FishDB[id] then str = str .. " " .. FishDB[id] end end)
                        for _, v in pairs(t) do if type(v) == "string" then str = str .. " " .. string.lower(v) elseif type(v) == "table" then extract(v, d + 1) end end
                    end
                    extract(args, 1)
                    if str == "" then return end
                    
                    local uuid = nil
                    local function getU(t, d)
                        if d > 5 or type(t) ~= "table" then return end
                        for _, v in pairs(t) do if type(v) == "string" and string.match(v, "^%x%x%x%x%x%x%x%x%-%x%x%x%x%-%x%x%x%x%-%x%x%x%x%-%x%x%x%x%x%x%x%x%x%x%x%x$") then uuid = v; return elseif type(v) == "table" and not uuid then getU(v, d + 1) end end
                    end
                    getU(args, 1)
                    if not uuid then return end

                    str = string.lower(string.gsub(str, "_", " "))
                    totalSemuaIkan = totalSemuaIkan + 1

                    local caught = nil
                    for tName, _ in pairs(TARGET_FISH) do if string.find(str, tName) then caught = tName; break end end

                    if caught then
                        local isGem = (caught == "ruby" and string.find(str, "gemstone"))
                        if caught == "ruby" and not isGem then return end
                        
                        totalIkanSultan = totalIkanSultan + 1
                        namaSultanTerakhir = isGem and "Gemstone Ruby" or caught

                        if isGem then
                            isLockingItem = true 
                            task.spawn(function()
                                task.wait(1.5) 
                                for _, r in ipairs(net:GetChildren()) do
                                    if string.find(string.lower(r.Name), "favorite") or string.find(r.Name, "~6xs") then
                                        task.spawn(function() pcall(function() if r:IsA("RemoteFunction") then r:InvokeServer(uuid, true) else r:FireServer(uuid, true) end end) end)
                                    end
                                end
                                task.wait(1); isLockingItem = false 
                            end)
                        end
                    end
                    updateDashboard()
                end)
            end
        end

        local isFarming = true
        updateDashboard()

        if AUTO_SELL then
            task.spawn(function()
                while isFarming do
                    task.wait(SELL_INTERVAL)
                    if not isLockingItem then
                        for _, r in ipairs(net:GetChildren()) do
                            if r:IsA("RemoteFunction") and (string.find(string.lower(r.Name), "sellall") or (string.find(r.Name, ",:np") and string.len(r.Name) > 12)) then
                                task.spawn(function() pcall(function() r:InvokeServer() end) end)
                            end
                        end
                    end
                end
            end)
        end
    end)
    if not success then label.Text = "ETZO V10.2 - ERROR!\n" .. tostring(errorMessage); label.TextColor3 = Color3.new(1, 0, 0) end
end)
